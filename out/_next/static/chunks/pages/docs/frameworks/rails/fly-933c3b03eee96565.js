(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3409],{3037:function(n,s,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/frameworks/rails/fly",function(){return e(5686)}])},9061:function(n,s,e){"use strict";e.d(s,{N:function(){return a}});var o=e(5893);function a(n){return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("div",{className:"flex-grow",children:(0,o.jsxs)("h5",{children:[(0,o.jsx)("a",{href:"/docs#frameworks",children:"Frameworks"})," ",n.framework?(0,o.jsxs)("span",{children:["› ",(0,o.jsx)("a",{href:n.url,children:n.framework})]}):(0,o.jsx)("span",{})]})}),(0,o.jsx)("div",{className:"flex flex-shrink justify-end gap-2",children:n.icon})]})})}},5404:function(n,s,e){"use strict";e.d(s,{X:function(){return a}});var o=e(5893);function a(n){return(0,o.jsx)("p",{className:"lead mt-1",children:n.lead})}},1370:function(n,s,e){"use strict";e.d(s,{c:function(){return t}});var o=e(5893),a=e(5675),l=e.n(a);function t(n){return(0,o.jsx)("div",{className:"w-full p-7 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-md",children:(0,o.jsxs)("div",{className:"border border-zinc-300 dark:border-zinc-800 text-zinc-100 text-sm subpixel-antialiased rounded-lg leading-normal overflow-hidden shadow-lg",children:[(0,o.jsx)("div",{className:"p-0 bg-zinc-200 dark:bg-black border-b border-zinc-300 dark:border-zinc-800",children:(0,o.jsxs)("div",{className:"flex py-1 px-2",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,o.jsx)("span",{className:"h-2 w-2 bg-red-500/70 dark:bg-red-500/30 rounded-full"}),(0,o.jsx)("span",{className:"h-2 w-2 bg-orange-300/70 dark:bg-orange-300/30 rounded-full"}),(0,o.jsx)("span",{className:"h-2 w-2 bg-green-500/70 dark:bg-green-500/30 rounded-full"})]}),(0,o.jsx)("div",{className:"text-right w-full text-zinc-400 text-xs",children:n.www})]})}),(0,o.jsx)("div",{className:"p-0",children:(0,o.jsx)("a",{href:n.url,target:"_blank",rel:"noreferrer",className:"hover:brightness-105",children:(0,o.jsx)(l(),{src:n.url,width:"0",height:"0",alt:"",className:"p-0 m-0 w-full",unoptimized:!0})})})]})})}},8297:function(n,s,e){"use strict";e.d(s,{M:function(){return a}});var o=e(5893);function a(n){return(0,o.jsxs)("svg",{fill:"currentColor",viewBox:"0 0 32 32",fillRule:"evenodd",...n,children:[(0,o.jsx)("path",{d:"M16.06 26.56c.038.01.077.017.112.033s.066.042.098.063l.006.006.032.028.055.05.238.222.43.432.442.495.266.337.235.34.186.317.136.292c.07.172.12.354.138.54l.006.103v.1l-.01.154c-.02.206-.066.4-.143.6a1.96 1.96 0 0 1-.2.372 2 2 0 0 1-.22.266 2.01 2.01 0 0 1-.206.182 2.08 2.08 0 0 1-.18.126l-.155.1c-.3.162-.653.253-1 .288l-.16.012-.178.004a3.24 3.24 0 0 1-.367-.022c-.203-.024-.404-.067-.597-.134a2.45 2.45 0 0 1-.477-.222c-.16-.098-.3-.215-.438-.352l-.23-.295c-.063-.1-.118-.205-.162-.314a2.09 2.09 0 0 1-.141-.57l-.012-.184.002-.147a1.65 1.65 0 0 1 .04-.267 2.18 2.18 0 0 1 .088-.284 3.09 3.09 0 0 1 .123-.276l.18-.32.22-.325.375-.474.427-.47.4-.4.172-.16.14-.126a.56.56 0 0 1 .21-.097zM16.244.004l.275.007.122.007.747.06 1.03.144.075.017 1 .246.282.083.32.1.4.146.302.126.47.22.263.133.532.3.163.098.726.524.177.154.5.452.43.456.118.13.503.662.076.12.388.648.1.207.22.482.228.562.076.218.243.877.2 1.185.033.368.03.53.002.077-.01.592-.007.1-.03.233-.167.945-.025.115-.384 1.186-.357.855-.454.9-.814 1.405-.42.633-.507.75-.366.496-.713.945-.5.6-.723.873-.505.585-.785.876-.494.537-1.495 1.546-.783.762-.433.407-.027.025-.033.03-.043.03-.03.014-.085.028-.204-.01-.018-.006-.1-.07-.014-.013-.015-.013-.058-.054-.173-.162-1.434-1.4-.444-.456-1.135-1.208-.27-.293-1.368-1.584-.383-.47-1.21-1.552-.12-.158-.916-1.335-.248-.397-.666-1.12-.2-.347-.575-1.2-.1-.235-.33-.92L6 11.45l-.093-.378-.08-.413-.063-.462-.024-.28-.01-.527.002-.1.014-.284.115-1.15.027-.148.26-1.148.006-.02.043-.128.183-.53.056-.134.297-.65.202-.378.286-.468.285-.416.198-.26.233-.278.255-.28.208-.2.548-.478.4-.332.484-.325.344-.22.73-.382 1.088-.447.922-.267.362-.08.498-.1.337-.05.52-.064.35-.03.704-.038.26-.003h.063l.224.005zm-.6 1.63l-.3.045c-.154.03-.306.07-.455.12a3.48 3.48 0 0 0-.467.199l-.292.168c-.705.448-1.244 1.12-1.64 1.847l-.188.37-.196.454-.215.6-.2.763-.186.98-.133 1.26-.033.804.018.924a13.86 13.86 0 0 0 .337 2.137c.205.886.472 1.758.773 2.616l1.28 3.178 1.888 3.8.05.093V1.633l-.024.002zm2.665.05a9.82 9.82 0 0 1 1.382.39c.64.234 1.257.54 1.823.92.768.516 1.44 1.172 1.96 1.938a7.25 7.25 0 0 1 .759 1.449c.292.75.46 1.547.53 2.348l.033.632-.012.588c-.035.44-.127.872-.25 1.294a10.06 10.06 0 0 1-.358 1.018l-.57 1.217a23.02 23.02 0 0 1-1.56 2.54c-.7 1.005-1.457 1.97-2.247 2.906l-2.582 2.844-.114.117 1.775-3.598.862-2.06.804-2.316.462-1.777a14.25 14.25 0 0 0 .251-1.554l.048-.684.003-.626-.03-.8c-.065-1.074-.23-2.144-.545-3.174l-.228-.656-.208-.488c-.404-.873-.97-1.7-1.733-2.285l-.256-.186z"}),(0,o.jsx)("defs",{children:(0,o.jsxs)("linearGradient",{id:"A",x2:"81.448",gradientUnits:"userSpaceOnUse",x1:"5.74",y1:"0",y2:"32",children:[(0,o.jsx)("stop",{offset:"0",stopColor:"#109cf8"}),(0,o.jsx)("stop",{offset:"1",stopColor:"#935ee9"})]})})]})}},5485:function(n,s,e){"use strict";e.d(s,{u:function(){return a}});var o=e(5893);function a(n){return(0,o.jsx)("svg",{fill:"currentColor",viewBox:"0 0 24 24",...n,children:(0,o.jsx)("path",{d:"M7.523 7.781c-.187 0-.382.011-.582.035l.116.358c.175-.018.351-.024.527-.024h.06l-.12-.369zm2.315.358l-.024.4c.2.067.394.138.588.217l.026-.404c-.055-.03-.208-.104-.59-.213zm-4.988.23a9.597 9.597 0 00-.473.26l.28.426c.157-.097.308-.19.466-.268L4.85 8.37zm2.89.022a5.602 5.602 0 00-.654.027c-.443.04-.909.169-1.38.375-1.418.618-2.878 1.918-3.833 3.51-.955 1.591-1.291 3-1.4 3.603-.037.202-.05.313-.05.313h4.79s-.057-.26-.096-.678a8.18 8.18 0 01-.033-.732c0-.55.055-1.203.244-1.858.047-.163.103-.328.168-.49.065-.162.14-.321.225-.479.17-.314.381-.618.646-.894s.584-.525.963-.736c.248-.12.698-.365 1.346-.489.216-.041.453-.07.713-.076.26-.005.542.012.845.06.606.097 1.298.32 2.075.74.388.211.798.47 1.228.788.11-.09.211-.162.211-.162s-.196-.197-.547-.486c-.35-.29-.853-.672-1.467-1.043-.306-.186-.642-.37-.998-.538a8.852 8.852 0 00-1.129-.44 7.48 7.48 0 00-1.226-.27 6.048 6.048 0 00-.64-.045zm2.086 1.65l-.023.383c.2.006.4.03.6.072l.025-.375a4.32 4.32 0 00-.602-.08zm-1.418.146c-.206.061-.381.127-.533.194l.139.418c.175-.085.351-.157.527-.211l-.133-.4zm-6.008.024c-.157.151-.31.303-.449.455l.467.4c.127-.163.267-.327.412-.478l-.43-.377zm4.34.898c-.14.128-.266.267-.375.407l.291.435c.103-.151.224-.29.358-.43l-.274-.412zm.989.787v4.323h1.164v-1.043L9.9 16.219h1.721l-1.351-1.364s1.06-.09 1.06-1.46c0-1.37-1.285-1.499-1.285-1.499H7.729zm5.292.032c-.842 0-1.126.763-1.126 1.127v3.164h1.181v-.758h1.11v.758h1.146v-3.164c0-.922-.838-1.127-1.129-1.127h-1.182zm2.85 0v4.29h1.23v-4.29h-1.23zm1.733 0v4.291h2.88v-1.11h-1.656v-3.181h-1.224zm4.359 0c-.485 0-1.133.399-1.133 1.144v.383c0 .746.642 1.127 1.133 1.127 1.364.006-.327 0 .933 0v.533l-2.005.006v1.098h1.982c.406 0 1.103-.297 1.127-1.127v-.424c0-.71-.581-1.129-1.127-1.129h-.988v-.508h1.957v-1.103h-1.88zM5.668 12.8a5.75 5.75 0 00-.182.666l.49.388c.025-.236.069-.472.13-.709l-.438-.345zm7.771.15h.407c.327 0 .334.236.334.236v1.05h-1.11v-1.05s0-.236.37-.236zm-4.546.031h.933s.262.097.262.49c0 .395-.268.499-.268.499h-.927v-.989zm-8.59.061c-.115.26-.242.563-.303.727l.697.255c.08-.206.206-.504.303-.728l-.697-.254zm5.092 1.963c.012.321.043.584.074.765l.726.26a8.003 8.003 0 01-.144-.787l-.656-.238z"})})}},5686:function(n,s,e){"use strict";e.r(s),e.d(s,{__N_SSG:function(){return h}});var o=e(5893),a=e(1151),l=e(1490),t=e(1370),r=e(5404),i=e(9061),c=e(8297),p=e(5485);function d(n){let s=Object.assign({h1:"h1",p:"p",h2:"h2",a:"a",pre:"pre",code:"code"},(0,a.ah)(),n.components),{Note:e}=s;return e||function(n,s){throw Error("Expected "+(s?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Note",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.N,{framework:"Rails",url:"/docs/frameworks/rails",icon:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.u,{className:"h-9 w-9 text-[#CC0000]"}),(0,o.jsx)(c.M,{className:"h-9 w-9 text-[#7B3BE2]"})]})}),"\n",(0,o.jsx)(s.h1,{children:"Deploy a Rails App to Fly.io"}),"\n",(0,o.jsx)(r.X,{lead:"Deploy a Rails app with an encrypted .env.vault file to Fly.io."}),"\n",(0,o.jsx)(e,{children:(0,o.jsxs)(s.p,{children:["Find a complete ",(0,o.jsx)("a",{href:"https://github.com/dotenv-org/examples/tree/master/rails/fly",children:"code example on GitHub"})," for this guide."]})}),"\n",(0,o.jsx)(s.h2,{id:"initial-setup",children:"Initial setup"}),"\n",(0,o.jsxs)(s.p,{children:["Install ",(0,o.jsx)(s.a,{href:"https://github.com/rails/rails",children:"Rails"}),"."]}),"\n",(0,o.jsx)(s.pre,{code:"gem install rails\n",children:(0,o.jsx)(s.code,{children:"gem install rails\n"})}),"\n",(0,o.jsx)(s.p,{children:"Create a new Rails project."}),"\n",(0,o.jsx)(s.pre,{code:"rails new yourapp\n",children:(0,o.jsx)(s.code,{children:"rails new yourapp\n"})}),"\n",(0,o.jsxs)(s.p,{children:["Edit ",(0,o.jsx)(s.code,{children:"config/routes.rb"})," and set root to ",(0,o.jsx)(s.code,{children:"www#index"}),"."]}),"\n",(0,o.jsx)(s.pre,{language:"ruby",code:'Rails.application.routes.draw do\n  get "up" => "rails/health#show", as: :rails_health_check\n  root "www#index"\nend\n',children:(0,o.jsx)(s.code,{className:"language-ruby",children:'<span><span style="color: var(--shiki-token-constant)">Rails</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-color-text)">application</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-color-text)">routes</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-color-text)">draw </span><span style="color: var(--shiki-token-keyword)">do</span></span>\n<span><span style="color: var(--shiki-color-text)">  get </span><span style="color: var(--shiki-token-string-expression)">&quot;up&quot;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;rails/health#show&quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> as: :rails_health_check</span></span>\n<span><span style="color: var(--shiki-color-text)">  root </span><span style="color: var(--shiki-token-string-expression)">&quot;www#index&quot;</span></span>\n<span><span style="color: var(--shiki-token-keyword)">end</span></span>\n<span></span>'}),title:"config/routes.rb"}),"\n",(0,o.jsxs)(s.p,{children:["Create ",(0,o.jsx)(s.code,{children:"app/controllers/www_controller.rb"}),"."]}),"\n",(0,o.jsx)(s.pre,{language:"ruby",code:"class WwwController < ApplicationController\n  def index\n  end\nend\n",children:(0,o.jsx)(s.code,{className:"language-ruby",children:'<span><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">WwwController</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">ApplicationController</span></span>\n<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">def</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">index</span></span>\n<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">end</span></span>\n<span><span style="color: var(--shiki-token-keyword)">end</span></span>\n<span></span>'}),title:"app/controllers/www_controller.rb"}),"\n",(0,o.jsxs)(s.p,{children:["Create ",(0,o.jsx)(s.code,{children:"app/views/www/index.html.erb"}),"."]}),"\n",(0,o.jsx)(s.pre,{language:"erb",code:'Hello <%= ENV["HELLO"] %>.\n',children:(0,o.jsx)(s.code,{className:"language-erb",children:'<span><span style="color: var(--shiki-color-text)">Hello &lt;%= </span><span style="color: var(--shiki-token-constant)">ENV</span><span style="color: var(--shiki-color-text)">[</span><span style="color: var(--shiki-token-string-expression)">&quot;HELLO&quot;</span><span style="color: var(--shiki-color-text)">] %&gt;.</span></span>\n<span></span>'}),title:"app/views/www/index.html.erb"}),"\n",(0,o.jsx)(s.p,{children:"Commit that to code and push it to Fly.io."}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"brew install flyctl\nflyctl launch\nflyctl deploy --remote-only --no-cache\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">brew install flyctl</span></span>\n<span><span style="color: var(--shiki-color-text)">flyctl launch</span></span>\n<span><span style="color: var(--shiki-color-text)">flyctl deploy --remote-only --no-cache</span></span>\n<span></span>'})}),"\n",(0,o.jsx)(t.c,{url:"/assets/img/docs/hello-blank.png",www:"yourapp.fly.dev"}),"\n",(0,o.jsxs)(s.p,{children:["Once deployed, your app will say ",(0,o.jsx)(s.code,{children:"'Hello .'"})," as it doesn't have a way to access the environment variable yet. Let's do that next."]}),"\n",(0,o.jsx)(s.h2,{id:"install-dotenv-vault-rails",children:"Install dotenv-vault-rails"}),"\n",(0,o.jsxs)(s.p,{children:["Add ",(0,o.jsx)(s.a,{href:"https://github.com/dotenv-org/dotenv-vault-ruby",children:(0,o.jsx)(s.code,{children:"dotenv-vault-rails"})})," to the top of your Gemfile."]}),"\n",(0,o.jsx)(s.pre,{language:"ruby",code:'source "https://rubygems.org"\nruby "3.1.3"\ngem "dotenv-vault-rails", require: "dotenv-vault/rails-now"\ngem "rails", "~> 7.1.1"\n...\n',children:(0,o.jsx)(s.code,{className:"language-ruby",children:'<span><span style="color: var(--shiki-color-text)">source </span><span style="color: var(--shiki-token-string-expression)">&quot;https://rubygems.org&quot;</span></span>\n<span><span style="color: var(--shiki-color-text)">ruby </span><span style="color: var(--shiki-token-string-expression)">&quot;3.1.3&quot;</span></span>\n<span><span style="color: var(--shiki-color-text)">gem </span><span style="color: var(--shiki-token-string-expression)">&quot;dotenv-vault-rails&quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> require: </span><span style="color: var(--shiki-token-string-expression)">&quot;dotenv-vault/rails-now&quot;</span></span>\n<span><span style="color: var(--shiki-color-text)">gem </span><span style="color: var(--shiki-token-string-expression)">&quot;rails&quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;~&gt; 7.1.1&quot;</span></span>\n<span><span style="color: var(--shiki-token-punctuation)">...</span></span>\n<span></span>'}),title:"Gemfile"}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"bundle install\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">bundle install</span></span>\n<span></span>'})}),"\n",(0,o.jsxs)(s.p,{children:["Create a ",(0,o.jsx)(s.code,{children:".env"})," file in the root of your project."]}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:'# .env\nHELLO="World"\n',children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-token-comment)"># .env</span></span>\n<span><span style="color: var(--shiki-color-text)">HELLO=</span><span style="color: var(--shiki-token-string-expression)">&quot;World&quot;</span></span>\n<span></span>'}),title:".env"}),"\n",(0,o.jsx)(s.p,{children:"Try running it locally."}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"bin/rails server\n=> Booting Puma\n=> Rails 7.1.1 application starting in development\n* Listening on http://127.0.0.1:3000\n* Listening on http://[::1]:3000\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">bin/rails server</span></span>\n<span><span style="color: var(--shiki-color-text)">=</span><span style="color: var(--shiki-token-keyword)">&gt;</span><span style="color: var(--shiki-color-text)"> Booting Puma</span></span>\n<span><span style="color: var(--shiki-color-text)">=</span><span style="color: var(--shiki-token-keyword)">&gt;</span><span style="color: var(--shiki-color-text)"> Rails 7.1.1 application starting </span><span style="color: var(--shiki-token-keyword)">in</span><span style="color: var(--shiki-color-text)"> development</span></span>\n<span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> Listening on http://127.0.0.1:3000</span></span>\n<span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> Listening on http://[::1]:3000</span></span>\n<span></span>'})}),"\n",(0,o.jsxs)(s.p,{children:["It should say ",(0,o.jsx)(s.code,{children:"Hello World"}),"."]}),"\n",(0,o.jsx)(t.c,{url:"/assets/img/docs/nextjs-hello-world.png"}),"\n",(0,o.jsxs)(s.p,{children:["Great! ",(0,o.jsx)(s.code,{children:"ENV"})," now has the keys and values you defined in your ",(0,o.jsx)(s.code,{children:".env"})," file. That covers local development. Let's solve for production next."]}),"\n",(0,o.jsx)(s.h2,{id:"build-env-vault",children:"Build .env.vault"}),"\n",(0,o.jsxs)(s.p,{children:["Push your latest ",(0,o.jsx)(s.code,{children:".env"})," file changes and edit your production secrets. ",(0,o.jsx)(s.a,{href:"/docs/tutorials/sync",children:"Learn more about syncing"})]}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"npx dotenv-vault@latest push\nnpx dotenv-vault@latest open production\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">npx dotenv-vault@latest push</span></span>\n<span><span style="color: var(--shiki-color-text)">npx dotenv-vault@latest open production</span></span>\n<span></span>'})}),"\n",(0,o.jsx)(s.p,{children:"Use the UI to configure those secrets per environment."}),"\n",(0,o.jsx)(t.c,{url:"/assets/img/docs/edit-production-value.gif",www:"www.dotenv.org"}),"\n",(0,o.jsxs)(s.p,{children:["Then build your encrypted ",(0,o.jsx)(s.code,{children:".env.vault"})," file."]}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"npx dotenv-vault@latest build\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">npx dotenv-vault@latest build</span></span>\n<span></span>'})}),"\n",(0,o.jsx)(s.p,{children:"Its contents should look something like this."}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:'#/-------------------.env.vault---------------------/\n#/         cloud-agnostic vaulting standard         /\n#/   [how it works](https://dotenv.org/env-vault)   /\n#/--------------------------------------------------/\n\n# development\nDOTENV_VAULT_DEVELOPMENT="/HqNgQWsf6Oh6XB9pI/CGkdgCe6d4/vWZHgP50RRoDTzkzPQk/xOaQs="\nDOTENV_VAULT_DEVELOPMENT_VERSION=2\n\n# production\nDOTENV_VAULT_PRODUCTION="x26PuIKQ/xZ5eKrYomKngM+dO/9v1vxhwslE/zjHdg3l+H6q6PheB5GVDVIbZg=="\nDOTENV_VAULT_PRODUCTION_VERSION=2\n',children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-token-comment)">#/-------------------.env.vault---------------------/</span></span>\n<span><span style="color: var(--shiki-token-comment)">#/         cloud-agnostic vaulting standard         /</span></span>\n<span><span style="color: var(--shiki-token-comment)">#/   [how it works](https://dotenv.org/env-vault)   /</span></span>\n<span><span style="color: var(--shiki-token-comment)">#/--------------------------------------------------/</span></span>\n<span></span>\n<span><span style="color: var(--shiki-token-comment)"># development</span></span>\n<span><span style="color: var(--shiki-color-text)">DOTENV_VAULT_DEVELOPMENT=</span><span style="color: var(--shiki-token-string-expression)">&quot;/HqNgQWsf6Oh6XB9pI/CGkdgCe6d4/vWZHgP50RRoDTzkzPQk/xOaQs=&quot;</span></span>\n<span><span style="color: var(--shiki-color-text)">DOTENV_VAULT_DEVELOPMENT_VERSION=2</span></span>\n<span></span>\n<span><span style="color: var(--shiki-token-comment)"># production</span></span>\n<span><span style="color: var(--shiki-color-text)">DOTENV_VAULT_PRODUCTION=</span><span style="color: var(--shiki-token-string-expression)">&quot;x26PuIKQ/xZ5eKrYomKngM+dO/9v1vxhwslE/zjHdg3l+H6q6PheB5GVDVIbZg==&quot;</span></span>\n<span><span style="color: var(--shiki-color-text)">DOTENV_VAULT_PRODUCTION_VERSION=2</span></span>\n<span></span>'}),title:".env.vault"}),"\n",(0,o.jsx)(s.h2,{id:"set-dotenv-key",children:"Set DOTENV_KEY"}),"\n",(0,o.jsxs)(s.p,{children:["Fetch your production ",(0,o.jsx)(s.code,{children:"DOTENV_KEY"}),"."]}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"npx dotenv-vault@latest keys production\n# outputs: dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=production\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">npx dotenv-vault@latest keys production</span></span>\n<span><span style="color: var(--shiki-token-comment)"># outputs: dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=production</span></span>\n<span></span>'})}),"\n",(0,o.jsxs)(s.p,{children:["Set ",(0,o.jsx)(s.code,{children:"DOTENV_KEY"})," on Fly.io."]}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"flyctl secrets set RAILS_ENV=production DOTENV_KEY='dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=production'\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">flyctl secrets </span><span style="color: var(--shiki-token-function)">set</span><span style="color: var(--shiki-color-text)"> RAILS_ENV=production DOTENV_KEY=</span><span style="color: var(--shiki-token-string-expression)">&#39;dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=production&#39;</span></span>\n<span></span>'})}),"\n",(0,o.jsx)(s.h2,{id:"deploy",children:"Deploy"}),"\n",(0,o.jsx)(s.p,{children:"Commit those changes safely to code and deploy again."}),"\n",(0,o.jsx)(s.pre,{language:"shell",code:"flyctl deploy --remote-only --no-cache\n",children:(0,o.jsx)(s.code,{className:"language-shell",children:'<span><span style="color: var(--shiki-color-text)">flyctl deploy --remote-only --no-cache</span></span>\n<span></span>'})}),"\n",(0,o.jsxs)(s.p,{children:["That's it! On deploy, your ",(0,o.jsx)(s.code,{children:".env.vault"})," file will be decrypted and its production secrets injected as environment variables‚ just in time."]}),"\n",(0,o.jsx)(t.c,{url:"/assets/img/docs/hello-production.png",www:"yourapp.fly.dev"}),"\n",(0,o.jsxs)(s.p,{children:["You'll know things worked correctly when you see ",(0,o.jsx)(s.code,{children:"Loading env from encrypted .env.vault"})," in your logs. If a ",(0,o.jsx)(s.code,{children:"DOTENV_KEY"})," is not set (for example when developing on your local machine) it will fall back to standard ",(0,o.jsx)(s.a,{href:"https://github.com/bkeepers/dotenv",children:"dotenv"})," functionality."]}),"\n",(0,o.jsx)(t.c,{url:"/assets/img/docs/fly-logs-vault-rails.png",www:"flyctl logs"}),"\n",(0,o.jsx)(l.default,{})]})}var h=!0;s.default=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,a.ah)(),n.components);return s?(0,o.jsx)(s,Object.assign({},n,{children:(0,o.jsx)(d,n)})):d(n)}},1490:function(n,s,e){"use strict";e.r(s),e.d(s,{__N_SSG:function(){return t}});var o=e(5893),a=e(1151);function l(n){let s=Object.assign({p:"p"},(0,a.ah)(),n.components),{Note:e}=s;return e||function(n,s){throw Error("Expected "+(s?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Note",!0),(0,o.jsx)(e,{children:(0,o.jsx)(s.p,{children:"You succesfully used the new .env.vault standard to encrypt and deploy your secrets. This is much safer than scattering your secrets across multiple third-party platforms and tools. Whenever you need to add or change a secret, just rebuild your .env.vault file and redeploy."})})}var t=!0;s.default=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,a.ah)(),n.components);return s?(0,o.jsx)(s,Object.assign({},n,{children:(0,o.jsx)(l,n)})):l(n)}}},function(n){n.O(0,[5675,9774,2888,179],function(){return n(n.s=3037)}),_N_E=n.O()}]);